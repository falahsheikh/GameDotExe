package com.thelocalmarketplace.software.test;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

import org.junit.Before;
import org.junit.Test;

import com.jjjwelectronics.Mass;
import com.jjjwelectronics.scale.ElectronicScale;
import com.thelocalmarketplace.hardware.SelfCheckoutStation;
import com.thelocalmarketplace.software.Software;

public class SoftwareTest {
	
	private Software software;
    private SelfCheckoutStation selfCheckoutStation;
    
    @Before
    public void setUp() {
        selfCheckoutStation = mock(SelfCheckoutStation.class);
        software = new Software(selfCheckoutStation);
    }
    
    
    
    @Test
    public void testWeightDiscrepancyWhenAddingItem() {
        // Mocking the scale and setting expected and current weights
        ElectronicScale scale = mock(ElectronicScale.class);
        software.scale = scale;
        software.expectedWeight = new Mass(1000); // Assuming expected weight is 1000 grams

        // Setting a different current weight to simulate weight discrepancy
        Mass currentWeight = new Mass(800);
        when(scale.getCurrentWeight()).thenReturn(currentWeight);

        // Triggering addItemViaBarcode()
        software.addItemViaBarcode();

        // Verifying that weight discrepancy messages are displayed
        assertFalse(software.allow);
    }
    
    @Test
    public void testWeightDiscrepancyWhenPayingViaCoin() {
        // Mocking the scale and setting expected and current weights
        ElectronicScale scale = mock(ElectronicScale.class);
        software.scale = scale;
        software.expectedWeight = new Mass(1500); // Assuming expected weight is 1500 grams

        // Setting a different current weight to simulate weight discrepancy
        Mass currentWeight = new Mass(1200);
        when(scale.getCurrentWeight()).thenReturn(currentWeight);

        // Triggering payViaCoin()
        software.payViaCoin();

        // Verifying that weight discrepancy messages are displayed
        assertFalse(software.allow);
    }
    
    @Test
    public void testWeightMatching() {
        // Mocking the scale and setting expected and current weights to be the same
        ElectronicScale scale = mock(ElectronicScale.class);
        software.scale = scale;
        software.expectedWeight = new Mass(500); // Assuming expected weight is 500 grams

        // Setting the current weight to match the expected weight
        Mass currentWeight = new Mass(500);
        when(scale.getCurrentWeight()).thenReturn(currentWeight);

        // Triggering addItemViaBarcode()
        software.addItemViaBarcode();

        // Verifying that allow is true as weights match
        assertTrue(software.allow);
    }
    
    

}
